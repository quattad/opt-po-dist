GAMS 25.1.3  r4e34d435fbd Released Oct 30, 2018 WEX-WEI x86 64bit/MS Windows - 02/28/19 17:21:43 Page 1
Determining Theoretical Trays Required for Propylene Oxide (PO) Separation
System --- Multicomponent with PO as light key and Methanol as heavy key at 2bar - 2.6bar.


   3   
      This model determines the number of theoretical trays required for PO
      separation based on the works of Viswanathan and Grossman.
       
      Variable
               Number of components in feed, c
               Molar flow rate, f
               Feed temperature, tf
               Feed pressure, pf
               Molar specific enthalpy of feed, zfc
               Vector of mole fractions, zf = {zf1, zf2, ..., zfc}
       
               Molar flow rate for liquid leaving tray i, l(i)
               Mole fraction of liquid stream leaving tray i, x(i)
               Molar specific enthalpy of liquid stream leaving tray i, hl(i)
               Fugacity of component j in liquid stream leaving tray i, fl(i,j)
       
               Molar flow rate for vapor leaving tray i, v(i)
               Mole fraction of vapor stream leaving tray i, y(i)
               Molar specific enthalpy of vapor stream leaving tray i, hv(i)
               Fugacity of component j in vapor stream leaving tray i, fv(i,j)
       
               Top Product Rate, P1
               Bottom Product Rate, P2
       
               Upper bound of liquid and vapor flowrates, fmax
       
      Positive Variable  // used for variables for which negative values are meaningless
       
      Sets
               Trays, I = {1, 2... N}; N is estimated from Gilliand correlation.
               Possible locations for feed, i_feed = {i_feed + 1, i_feed + 2... N-1}
               Possible locations for reflux, REF = {i_r_min, i_r_min + 1... N -1}
               Possible locations for boil-up, BU = {2, 3..., i_b_max - 1, i_b_max}
               Feed Location = {i_feed}
               Stages above feed, AF = {i|i_feed < i <= (N-1)}; REF subset of AF
               Stages below feed, BF = {i|2<= i < i_feed}; BU subset of BF
               Corresponding index set, J = {1, 2, ... , c}
       
      Subsets
               Reboiler, R = {1}
               Condenser, C = {N}
               Column Trays, COL = {2, 3, ..., N-1}
       
      Parameter
      Scalar
      Equation
               There are a total of 9 equations that need to be met that mainly
               correspond to the MESH equations.
       
               1) Phase Equlibrium
               2) Phase Equlibrium Error
               3) Total Material Balance
               4) Component Material Balances
               5) Enthalpy Balances
               6) Reflux single tray constraint
               7) Reboiler single tray constraint
               8) Pressure Profile
               9) Fugacity and enthalpy balances of each component on each tray
  64   
      DEFINE THERMODYNAMIC PROPERTIES
  68   
  69  * Include developed libraries in GAMS
  75   
  84   
  90   
FUNCLIBIN  NRTLideal NRTLideal.dll
Function Library NRTLideal
NRTL + IG Property Package v0.9 by Ph.D. J.I. Manassaldi (jmanassaldi@frro.utn.edu.ar); Ph.D. N.J. Scenna; Ph.D. M.C. Mussati; Ph.D. S.F. Mussati (mussati@santafe-conicet.gov.ar)
GAMS Development Corporation

Mod. Function                          Description
Type

NLP  rho_liq(temperature [k],pressure [bar],methanol,water,1,2-propylene oxide)liquid phase molar density [mol/m3]
NLP  rho_vap(temperature [k],pressure [bar],methanol,water,1,2-propylene oxide)vapor phase molar density [mol/m3]
NLP  h_liq(temperature [k],pressure [bar],methanol,water,1,2-propylene oxide)liquid phase molar enthalpy [J/mol]
NLP  h_vap(temperature [k],pressure [bar],methanol,water,1,2-propylene oxide)vapor phase molar enthalpy [J/mol]
NLP  s_liq(temperature [k],pressure [bar],methanol,water,1,2-propylene oxide)liquid phase molar entropy [J/(mol.K)]
NLP  s_vap(temperature [k],pressure [bar],methanol,water,1,2-propylene oxide)vapor phase molar entropy [J/(mol.K)]
NLP  f1_liq(temperature [k],pressure [bar],methanol,water,1,2-propylene oxide)liquid phase fugacity of component 1 [bar]
NLP  f1_vap(temperature [k],pressure [bar],methanol,water,1,2-propylene oxide)vapor phase fugacity of component 1 [bar]
NLP  f2_liq(temperature [k],pressure [bar],methanol,water,1,2-propylene oxide)liquid phase fugacity of component 2 [bar]
NLP  f2_vap(temperature [k],pressure [bar],methanol,water,1,2-propylene oxide)vapor phase fugacity of component 2 [bar]
NLP  f3_liq(temperature [k],pressure [bar],methanol,water,1,2-propylene oxide)liquid phase fugacity of component 3 [bar]
NLP  f3_vap(temperature [k],pressure [bar],methanol,water,1,2-propylene oxide)vapor phase fugacity of component 3 [bar]

  92   
  93  function f1l     /NRTLideal.f1_liq /;
  94  function f2l     /NRTLideal.f2_liq /;
  95  function f3l     /NRTLideal.f3_liq /;
  96   
  97  function f1v     /NRTLideal.f1_vap /;
  98  function f2v     /NRTLideal.f2_vap /;
  99  function f3v     /NRTLideal.f3_vap /;
 100   
 101  Set j 'components' / methanol, water, PO, PG /;
 102   
 103  * PG critical temp and pressure not pertinent
 104   
 105  Table prcon (j, *) 'physical properties'
 106                   mm      tb      tc      pc
 107    methanol    32.042  337.85  513.15  79.54
 108    water       18.015  373.15  647.35 220.89
 109    PO           58.08  307.38  482.25  49.24
 110    PG           76.09  460.15                            ;
 111   
 112  * all constants obtained from Perry's Chemical Engineering handbook except for PO and PG.
 113  * Pressures in Pa Formula for Perry: lnP = a + b/T + c*lnT + d*power(T,e)
 114  * PO obtained from 1966 paper in the format logP* = 7.658 - 1472/T. Applicable within range of 40-70oC.
 115   
 116  Table vpcon(j, *) "constants for vapor pressure"
 117                     a        b         c            d        e       tmin    tmax
 118    methanol    82.718  -6904.5   -8.8622    7.4664e-6        2     175.47   512.5
 119    water       73.649  -7258.2   -7.3037    4.1653e-6        2     273.16   647.096
 120    PO           7.658  -1472
 121    PG           212.8  -15420    -28.109    2.1564e-5        2                       ;
 122   
 123  * all constants obtained from Perry's Chemical Engineering handbook except for PO.
 124  * Specific heat capacity, CpL = a + b*T +c*power(T,2) + d*power(T,3) + e*power(T,4)
 125  * For PO in J/mol.K : a + b*T + c*power(T,2)
 126   
 127  Table cpcon (j, *) "isobaric heat capacity constants for liquid phase"
 128                      a         b          c              d         e
 129    methanol     105800   -362.23     0.9379
 130    water        276370   -2090.1     8.125        -0.014116  9.3701e-6
 131    PO           113.08   -0.15085    6.7e-4
 132    PG           58080      445.2                                            ;
 133   
 134  * Define temperatures for the 1 and N-1 trays, reboiler, condenser
 135  Scalar
 136           treb 'guess temperature for reboiler'
 137           tbot 'guess temperature for bottom tray'
 138           ttop 'guess temperature for top tray'
 139           tcon 'guess temperature for condenser';
 140   
 141  treb = 359.6;
 142  tbot = 357.5;
 143  ttop = 330.9;
 144  tcon = 326.1;
 145   
 146  * filled in from HYSYS simulation
 147  Scalar
 148           f       'total number of moles of feed'
 149           tf      'temperature of feed in K'
 150           pf      'pressure of feed stream in bar'
 151           vf      'vapor fraction in feed'
 152           shf     'specific enthalpy in feed'
 153           preb    'reboiler pressure'
 154           pbot    '1st tray pressure'
 155           ptop    'N-1 tray pressure'
 156           pcon    'condenser pressure';
 157   
 158  f = 6282;
 159  preb = 2.07;
 160  pbot = 1.97;
 161  ptop = 1.90;
 162  pcon = 1.80;
 163  pf = 18.48;
 164  vf = 0;
 165   
 166  Parameter xf(j) 'mole fractions in feed stream'
 167  /
 168           methanol 0.7515,
 169           water 0.1292,
 170           PO 0.1073,
 171           PG 0.0102      / ;
 172   
      MODELING DISTILLATION COLUMN
      Reboiler (1) ~ Condenser (N)
      Estimated number of trays is 9 from Gilliand correlation
 178   
 179  Set
 180    i              'stages' / 1*9 /
 181    reb(i)         'reboiler'
 182    con(i)         'condenser'
 183    col(i)         'stages in the column'
 184    floc(i)        'possible locations in the feed stage'  / 2*8 /
 185    above_feed(i)  'stages above the feed stage, excluding feed stage'
 186    below_feed(i)  'stages below feed stage, including feed stage';
 187   
 188  * operator 'ord' returns relative position of member in a set
 189  * card operator 'card' returns number of elements present in a set
 190  * yes$ used to define dynamic sets
 191  * dynamic sets have elements that are added/removed during runtime
 192  * ord used below to allocate
 193   
 194  *assigns first element in dynamic set to reboiler
 195  reb(i) = yes$(ord(i) = 1);
 196   
 197  *assigns last element in dynamic set to condenser
 198  con(i) = yes$(ord(i) = card(i));
 199   
 200  *assigns all other elements in dynamic set to the columns
 201  col(i) = yes - (reb(i) + con(i));
 202   
 203  * assigns the pressure on a particular tray depending on whether reboiler, condenser or
 204  * tray in column
 205   
 206  Parameter p(i) 'pressure prevailing in tray i';
 207  p(i)$reb(i) = preb;
 208  p(i)$con(i) = pcon;
 209  p(i)$col(i) = pbot - ( ((pbot - ptop) / card(i) - 1 - 2) ) * (ord(i) - 2);
 210   
 211  Positive Variable
 212    x(i,j) 'mole fraction of component j in liquid on ith tray'
 213    y(i,j) 'mole fraction of component j in vapor on ith tray'
 214    l(i)   'molar flow rate of liquid leaving tray i'
 215    v(i)   'molar flow rate of vapor leaving tray i'
 216    t(i)   'temperature of tray i'
 217    feed(i)'feed stream entering tray i'
 218    r      'reflux ratio'
 219    p1     'top product rate'
 220    p2     'bottom product rate'
 221    ref(i) 'amount of reflux entering tray i'
 222    bu(i)  'amount of reboiler stream entering tray i'
 223   
 224  Variable
 225    hl(i)  'molar specific enthalpy of liquid on tray i'
 226    hv(i)  'molar specific enthalpy of vapor on tray i'
 227   
 228  Binary Variable
 229    zref(i) 'associated with location of reflux. 1 if i is tray where reflux enters, 0 otherwise.'
 230    zbu(i) 'associated with location of reboiler stream. 1 if i is tray where reboiler stream enters, 0 otherwise.'
 231   
 232  Equation
 233    phe(i)    'phase equilibrium relations'
 234    errk(i)   'phase equilibrium error function'
 235    tmbc(i)   'total material balance for entire column'
 236    tmb(i)    'total material balance for trays'
 237    tmbl(i)   'total material balance for reboiler'
 238    tmbn(i)   'total material balance for condenser'
 239    cmb(i,j)  'component material balance (1 < i < n)'
 240    cmbl(i,j) 'component material balance on first tray'
 241    cmbn(i,j) 'component material balance on nth tray'
 242    defln(i)  'definition of l(n)'
 243    defp2(i)  'definition of p2'
 244    defhl(i)  'definition of hl(i)'
 245    defhv(i)  'definition of hv(i)'
 246    eb(i)     'enthalpy balance'
 247    purcon    'purity constraints'
 248    sumf      'sum of feeds';
 249   
 250  * (2) Phase Equlibrium Relations fij,v = fij,l
 251  phe(i) ..    f1l(300, 1.013, x(i,'methanol'), x(i,'water'), x(i,'PO')) =e= f1v(300, 101.3, y(i,'methanol'),y(i,'water'),y(i,'PO'));
 252   
      Attempted to use VLE equation here, but may not be necessary after including thermodynamic package?
      phe(i,j) ..             y(i,j)*p(i)
                              - x(i,j)*exp(
                                  vpcon(j, 'a')
                                  + (vpcon(j,'b') / t(i))
                                  + (vpcon(j,'c')*ln(t(i)))
                                  + (vpcon(j,'d')*t(i)*exp(vpcon(j,'e')))
                                  ); 
 263   
 264  * (3) Phase Equilibrium Error
 265  errk(i) ..               sum(j, x(i,j)) - sum(j, y(i,j)) =e= 0;
 266   
 267  * (4) Total Material Balances
 268  * There are a total of 11 material balance equations 1) Entire column
 269  * 2) Reflux 3) After the feed 4) At the feed location 5) Below the feed
 270  * 6) Liquid flow rate from first tray 7) Vapor flow rate from first tray
 271  * 8) Reflux balance 9) Liquid flow rate out of reboiler
 272   
 273  * TMB 3a Entire Column
 274  tmbc(i)..               v(i-1) - (sum(i, ref(i)$zref(i)) + l(i) + p1) =e= 0;
****                                         $125
**** 125  Set is under control already
 275   
 276  * TMB 3c,3d,3e are combined into a single equation
 277  tmb(i) ..                l(i) + v(i) - l(i+1) -v(i-1) + feed(i)$floc(i) =e= 0;
 278   
 279  * TMB 3f for reboiler. no liquid outlet stream.
 280  tmbl(i)$reb(i) ..        l(i) + v(i) - l(i+1) =e= 0;
 281   
 282  * TMB 3g for condenser. no vapor outlet stream.
 283  tmbn(i)$con(i) ..        l(i) + p1 - v(i-1) =e= 0;
 284   
 285  * Constraint on liquid flow rate out of condenser to reflux ratio of total product stream
 286  defln(i)$con(i) ..       l(i) - (r * p1) =e= 0;
 287   
 288  * Constraint on liquid flow rate out of reboiler
 289  defp2(i)$reb(i) ..       l(i) - p2 =e= 0;
 290   
 291  * Constraint on vapor flow rate out of condenser. May need to include.
 292   
 293  * Constraint on vapor flow rate out of reboiler. May need to include.
 294   
 295  * Component Material Balances
 296  * similar to TMB, but specifically for certain components
 297   
 298  * Component Material Balance for Column
 299  cmb(i,j)$col(i) ..       l(i)*x(i,j) + v(i)*y(i,j) - l(i+1)*x(i+1, j)
 300                           - v(i-1)*y(i-1,j) - (feed(i)*xf(j))$floc(i) =e= 0;
 301   
 302  * Component Material Balance for Reboiler
 303  cmbl(i,j)$reb(i) ..      l(i)*x(i,j) + v(i)*y(i,j) - l(i+1)*x(i+1,j) =e= 0;
 304   
 305  * Component Material Balance for Condenser
 306  cmbn(i,j)$con(i) ..      l(i)*x(i,j) + p1*x(i,j) - v(i-1)*y(i-1,j) =e= 0;
 307   
 308  * Enthalpy Balances
 309  eb(i)$col(i) ..          l(i)*hl(i) + v(i)*hv(i)
 310                           - l(i+1)*hl(i+1) - v(i-1)*hv(i-1)
 311                           - (feed(i)*shf)$floc(i) =e= 0;
 312   
 313  * Reflux entering only on one tray
 314   
 315  * Reboiled vapor entering only on one tray
 316   
 317  * Pressure profiles
 318   
 319  * Purity Constraint on PO
 320  purcon .. x('9', 'PO') =g= 0.85;
 321   
 322  * Initial guess for feed stage
 323  Set ifeed(i) / 4 /;
 324   
 325  * Boolean check if stage is above or below feed stream
 326   
 327  below_feed(i) = yes$(ord(i) le 6 );
 328  above_feed(i) = yes - below_feed(i);
 329   
 330  * assigns first iteration to lower limit
 331  feed.l(i)$ifeed(i) = f;
 332   
 333  * assigns lower, upper bounds and initial conditions to
 334  * reflux ratio, top product rate and bottom product rate
 335   
 336  r.l      = 6;
 337  r.up     = 8;
 338  r.lo     = 5;
 339   
 340  p1.l     = 2000;
 341  p1.up    = 3000;
 342  p1.lo    = 4000;
 343   
 344  p2.l     = 4000;
 345  p2.up    = 6000;
 346  p2.lo    = 7000;
 347   
 348  * set upper limits for mole fractions
 349   
 350  x.up(i,j) = 1.0;
 351  y.up(i,j) = 1.0;
 352   
      * Additional variables / equations for feed tray location problem;
      Binary Variable yf(i);
 357   
 358  Variable zf;
 359   
      Equation
        sumby         'sum of binary variables in vapor phase in feed'
        sumbl         'sum of binart variables in liquid phase in feed'
        confeed(i)    'constraint on feed'
        obj2          'second objective function'  ;
       
      * Binary variables in feed for both liquid and vapor phases should add up to 1
      sum(i$floc(i), yf(i))
 370   
 371  Model column 'ideal number of stages' / all /;
 372  Solve column using minlp maximizing zf;
****                                        $257
**** 257  Solve statement not checked because of previous errors

**** 2 ERROR(S)   0 WARNING(S)
GAMS 25.1.3  r4e34d435fbd Released Oct 30, 2018 WEX-WEI x86 64bit/MS Windows - 02/28/19 17:21:43 Page 2
Determining Theoretical Trays Required for Propylene Oxide (PO) Separation
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  D:\Software\GAMS\GAMS Studio Workspace\gamsdir\projdir\dist_col.gms
     2       91 FUNCLIBIN      1      91  NRTLideal.dll


COMPILATION TIME     =        0.031 SECONDS      3 MB  25.1.3 r4e34d435fbd WEX-WEI


USER: GAMS Development Corporation, USA              G871201/0000CA-ANY
      Free Demo, +1 202-342-0180, support@gams.com, www.gams.com DC0000


**** FILE SUMMARY

Input      D:\Software\GAMS\GAMS Studio Workspace\gamsdir\projdir\dist_col.gms
Output     D:\Software\GAMS\GAMS Studio Workspace\gamsdir\projdir\dist_col.lst

**** USER ERROR(S) ENCOUNTERED
